package spacelift

deny["Policy was denied"] {
    instance := input.terraform.resource_changes[_].change.after.instance_type
    instance != sanitized("t2.micro")
}

sample { true }


package spacelift

deny [ "Illegal port number" ] {
    
    resources := [ changes |
        changes := input.terraform.resource_changes[_]
        changes.type == "aws_security_group"
    ]

    resource = resources[_]

    any([
      resource.changes.after.ingress[_].from_port != 22,
      resource.changes.after.ingress[_].to_port != 22
    ])
}